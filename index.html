<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module Maths 2: Analyse Interactive</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- MathJax Configuration & Loader -->
    <!-- Important : La config doit √™tre d√©finie AVANT le chargement du script -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');

        /* <!-- Chosen Palette: Warm Sand & Slate --> */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fdfcf8; /* Warm off-white */
            color: #334155; /* Slate 700 */
        }

        /* Custom Chart Container Class as per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 650px; /* max-w-2xl equiv approx */
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        @media (max-width: 640px) {
            .chart-container {
                height: 300px;
            }
        }

        /* Matrix Brackets styling */
        .matrix-bracket {
            position: relative;
            padding: 0.5rem;
        }
        .matrix-bracket::before, .matrix-bracket::after {
            content: "";
            position: absolute;
            top: 0;
            bottom: 0;
            width: 8px;
            border: 2px solid #334155;
        }
        .matrix-bracket::before {
            left: 0;
            border-right: 0;
        }
        .matrix-bracket::after {
            right: 0;
            border-left: 0;
        }

        /* Hide scrollbar for clean UI */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Tab Transitions */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease-in-out;
        }
        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .input-num {
            transition: all 0.2s;
        }
        .input-num:focus {
            outline: none;
            border-color: #d97706;
            box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.1);
        }

        /* Custom scrollbar for content areas */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d6d3d1;
            border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a8a29e;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="bg-[#f4f1ea] border-b border-stone-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center gap-2">
                        <span class="text-2xl font-bold text-stone-800 tracking-tight">Maths<span class="text-amber-600">II</span></span>
                        <span class="text-xs font-semibold uppercase tracking-wider text-stone-500 mt-1 ml-2 hidden sm:block">Matrices & Graphes</span>
                    </div>
                </div>
                <div class="hidden sm:flex sm:space-x-8 items-center">
                    <button onclick="switchTab('home')" id="nav-home" class="nav-item border-amber-500 text-stone-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors duration-200">
                        Synth√®se & Cours
                    </button>
                    <button onclick="switchTab('matrices')" id="nav-matrices" class="nav-item border-transparent text-stone-500 hover:border-stone-300 hover:text-stone-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors duration-200">
                        Matrices
                    </button>
                    <button onclick="switchTab('graphes')" id="nav-graphes" class="nav-item border-transparent text-stone-500 hover:border-stone-300 hover:text-stone-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors duration-200">
                        Graphes
                    </button>
                    <button onclick="switchTab('markov')" id="nav-markov" class="nav-item border-transparent text-stone-500 hover:border-stone-300 hover:text-stone-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium transition-colors duration-200">
                        Cha√Ænes de Markov
                    </button>
                </div>
                <!-- Mobile menu button -->
                <div class="flex items-center sm:hidden">
                    <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="inline-flex items-center justify-center p-2 rounded-md text-stone-400 hover:text-stone-500 hover:bg-stone-100 focus:outline-none">
                        <span class="text-xl font-bold">‚ò∞</span>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden sm:hidden bg-[#f4f1ea] border-t border-stone-200">
            <div class="pt-2 pb-3 space-y-1">
                <button onclick="switchTab('home')" class="block pl-3 pr-4 py-2 border-l-4 border-amber-500 text-base font-medium text-amber-700 bg-amber-50 w-full text-left">Synth√®se</button>
                <button onclick="switchTab('matrices')" class="block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-stone-600 hover:bg-stone-50 hover:border-stone-300 w-full text-left">Matrices</button>
                <button onclick="switchTab('graphes')" class="block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-stone-600 hover:bg-stone-50 hover:border-stone-300 w-full text-left">Graphes</button>
                <button onclick="switchTab('markov')" class="block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-stone-600 hover:bg-stone-50 hover:border-stone-300 w-full text-left">Markov</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">

        <!-- SECTION: HOME / SYNTH√àSE -->
        <section id="home" class="tab-content active">
            <div class="text-center mb-12">
                <h1 class="text-4xl font-bold text-stone-900 mb-4">Module Maths 2 : Synth√®se & R√©vision</h1>
                <p class="text-lg text-stone-600 max-w-3xl mx-auto leading-relaxed">
                    Explorez les concepts cl√©s de l'alg√®bre lin√©aire, des graphes et des probabilit√©s.
                    Utilisez les onglets ci-dessus pour acc√©der aux simulateurs interactifs.
                </p>
            </div>

            <!-- Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                <!-- Card 1 -->
                <div class="bg-white rounded-xl shadow-sm border border-stone-100 p-6 hover:shadow-md transition-shadow cursor-pointer group" onclick="switchTab('matrices')">
                    <div class="w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center mb-4 text-amber-600 font-bold text-xl group-hover:scale-110 transition-transform">M</div>
                    <h2 class="text-xl font-bold text-stone-900 mb-2">Matrices</h2>
                    <p class="text-stone-600 text-sm mb-4">
                        Tableaux de nombres $M_{n,p}(\mathbb{R})$, op√©rations, d√©terminants.
                    </p>
                </div>

                <!-- Card 2 -->
                <div class="bg-white rounded-xl shadow-sm border border-stone-100 p-6 hover:shadow-md transition-shadow cursor-pointer group" onclick="switchTab('graphes')">
                    <div class="w-12 h-12 bg-emerald-100 rounded-lg flex items-center justify-center mb-4 text-emerald-600 font-bold text-xl group-hover:scale-110 transition-transform">G</div>
                    <h2 class="text-xl font-bold text-stone-900 mb-2">Graphes</h2>
                    <p class="text-stone-600 text-sm mb-4">
                        Mod√©lisation, Dijkstra, et optimisation de chemins.
                    </p>
                </div>

                <!-- Card 3 -->
                <div class="bg-white rounded-xl shadow-sm border border-stone-100 p-6 hover:shadow-md transition-shadow cursor-pointer group" onclick="switchTab('markov')">
                    <div class="w-12 h-12 bg-sky-100 rounded-lg flex items-center justify-center mb-4 text-sky-600 font-bold text-xl group-hover:scale-110 transition-transform">P</div>
                    <h2 class="text-xl font-bold text-stone-900 mb-2">Cha√Ænes de Markov</h2>
                    <p class="text-stone-600 text-sm mb-4">
                        Processus sans m√©moire, matrices de transition et convergence.
                    </p>
                </div>
            </div>

            <!-- COURS / R√âSUM√â ADDITION -->
            <div class="bg-white border border-stone-200 rounded-xl overflow-hidden shadow-sm">
                <div class="bg-stone-50 px-6 py-4 border-b border-stone-200">
                    <h3 class="font-bold text-xl text-stone-800 flex items-center">
                        <span class="text-2xl mr-2">üìù</span> Fiche de R√©vision : Les Cha√Ænes de Markov
                    </h3>
                </div>
                
                <div class="p-8 space-y-8 text-stone-700">
                    
                    <!-- Section 1 -->
                    <div>
                        <h4 class="text-lg font-bold text-amber-600 mb-3 border-b border-amber-100 pb-1">1. Notions Fondamentales</h4>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-stone-50 p-4 rounded-lg">
                                <h5 class="font-bold text-stone-800 mb-2">A. Le Graphe Probabiliste</h5>
                                <ul class="list-disc pl-5 text-sm space-y-1">
                                    <li>Graphe <strong>orient√©</strong> et <strong>pond√©r√©</strong>.</li>
                                    <li>Sommets = <strong>√âtats</strong> du syst√®me.</li>
                                    <li>Poids des arcs = <strong>Probabilit√©s</strong>.</li>
                                    <li><strong class="text-amber-700">R√®gle d'or :</strong> La somme des poids sortant d'un sommet vaut toujours 1.</li>
                                </ul>
                            </div>
                            <div class="bg-stone-50 p-4 rounded-lg">
                                <h5 class="font-bold text-stone-800 mb-2">B. L'√âtat Probabiliste</h5>
                                <p class="text-sm mb-2">C'est une "photo" de la r√©partition des probabilit√©s √† l'instant $n$. Il se note comme un vecteur ligne :</p>
                                <div class="text-center py-2 bg-white rounded border border-stone-200 text-sm">
                                    $$ P_n = (a_1 \quad a_2 \quad \dots \quad a_m) $$
                                </div>
                                <p class="text-xs text-stone-500 mt-2 text-center">Avec $ \sum a_i = 1 $</p>
                            </div>
                        </div>
                    </div>

                    <!-- Section 2 & 3 -->
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="text-lg font-bold text-amber-600 mb-3 border-b border-amber-100 pb-1">2. D√©finition</h4>
                            <p class="text-sm mb-2">Un processus est une cha√Æne de Markov si :</p>
                            <ol class="list-decimal pl-5 text-sm space-y-2">
                                <li><strong>Absence de m√©moire :</strong> L'√©tat futur $(n+1)$ ne d√©pend que de l'√©tat pr√©sent $(n)$.</li>
                                <li><strong>Homog√©n√©it√© :</strong> Les probabilit√©s de transition ne changent pas avec le temps.</li>
                            </ol>
                        </div>
                        <div>
                            <h4 class="text-lg font-bold text-amber-600 mb-3 border-b border-amber-100 pb-1">3. La Matrice de Transition $T$</h4>
                            <p class="text-sm mb-2">C'est une matrice carr√©e $m \times m$.</p>
                            <ul class="list-disc pl-5 text-sm space-y-1">
                                <li>$t_{ij}$ = Probabilit√© de passer de l'√©tat $i$ √† l'√©tat $j$.</li>
                                <li>Lecture : <strong>"De la Ligne... Vers la Colonne"</strong>.</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Section 4: Formules -->
                    <div>
                        <h4 class="text-lg font-bold text-amber-600 mb-3 border-b border-amber-100 pb-1">4. √âvolution du Syst√®me (Formules)</h4>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-sky-50 p-4 rounded-lg border border-sky-100 text-center">
                                <span class="block text-xs font-bold text-sky-600 uppercase mb-2">De proche en proche</span>
                                <span class="text-xl font-bold text-stone-800">$ P_{n+1} = P_n \times T $</span>
                            </div>
                            <div class="bg-emerald-50 p-4 rounded-lg border border-emerald-100 text-center">
                                <span class="block text-xs font-bold text-emerald-600 uppercase mb-2">Fonction de l'√©tat initial</span>
                                <span class="text-xl font-bold text-stone-800">$ P_n = P_0 \times T^n $</span>
                            </div>
                        </div>
                    </div>

                    <!-- Section 5: √âtat Stable -->
                    <div>
                        <h4 class="text-lg font-bold text-amber-600 mb-3 border-b border-amber-100 pb-1">5. √âtat Stable (Stationnaire)</h4>
                        <p class="text-sm mb-4">Un √©tat $P$ est stable s'il ne varie plus : $ P = P \times T $.</p>
                        
                        <div class="bg-stone-800 text-stone-100 p-6 rounded-lg shadow-inner">
                            <h5 class="font-bold text-amber-400 mb-4 border-b border-stone-700 pb-2">Exemple de R√©solution</h5>
                            <div class="grid md:grid-cols-2 gap-8">
                                <div>
                                    <p class="text-xs text-stone-400 uppercase mb-1">Syst√®me √† r√©soudre</p>
                                    <p class="text-sm">Pour trouver $ P = (x \quad y) $, on pose :</p>
                                    <div class="my-2 pl-4 border-l-2 border-amber-500 font-mono text-sm">
                                        1. $ (x \quad y) \times T = (x \quad y) $<br>
                                        2. $ x + y = 1 $
                                    </div>
                                </div>
                                <div>
                                    <p class="text-xs text-stone-400 uppercase mb-1">Th√©or√®me de Convergence</p>
                                    <p class="text-sm italic">
                                        "Pour une cha√Æne d'ordre 2 (matrice sans 0), la suite $P_n$ finit toujours par converger vers l'unique √©tat stable $P$."
                                    </p>
                                    <div class="mt-2 text-right">
                                        $$ \lim_{n \to +\infty} P_n = P $$
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- SECTION: MATRICES -->
        <section id="matrices" class="tab-content">
            <div class="mb-8 border-b border-stone-200 pb-4">
                <h2 class="text-3xl font-bold text-stone-800">L'Atelier des Matrices</h2>
                <p class="text-stone-600 mt-2">
                    Une matrice de type $(n,p)$ est un tableau de nombres r√©els. Ici, nous nous concentrons sur les matrices carr√©es $2 \times 2$ pour illustrer le <strong>Produit Matriciel</strong> et le <strong>D√©terminant</strong>.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- Interactive Calculator -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                    <h3 class="text-lg font-bold text-stone-800 mb-6 flex items-center">
                        <span class="w-2 h-2 bg-amber-500 rounded-full mr-2"></span>Calculateur Interactif $(A \times B)$
                    </h3>

                    <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-8 overflow-x-auto">
                        <!-- Matrix A -->
                        <div class="text-center">
                            <div class="font-bold text-stone-400 mb-2 text-xs uppercase tracking-widest">Matrice A</div>
                            <div class="matrix-bracket grid grid-cols-2 gap-2">
                                <input type="number" id="a11" value="2" class="input-num w-12 h-10 text-center bg-stone-50 border border-stone-300 rounded text-stone-800 font-mono" oninput="calculateMatrix()">
                                <input type="number" id="a12" value="1" class="input-num w-12 h-10 text-center bg-stone-50 border border-stone-300 rounded text-stone-800 font-mono" oninput="calculateMatrix()">
                                <input type="number" id="a21" value="5" class="input-num w-12 h-10 text-center bg-stone-50 border border-stone-300 rounded text-stone-800 font-mono" oninput="calculateMatrix()">
                                <input type="number" id="a22" value="2" class="input-num w-12 h-10 text-center bg-stone-50 border border-stone-300 rounded text-stone-800 font-mono" oninput="calculateMatrix()">
                            </div>
                        </div>

                        <div class="text-2xl font-bold text-stone-300">√ó</div>

                        <!-- Matrix B -->
                        <div class="text-center">
                            <div class="font-bold text-stone-400 mb-2 text-xs uppercase tracking-widest">Matrice B</div>
                            <div class="matrix-bracket grid grid-cols-2 gap-2">
                                <input type="number" id="b11" value="1" class="input-num w-12 h-10 text-center bg-stone-50 border border-stone-300 rounded text-stone-800 font-mono" oninput="calculateMatrix()">
                                <input type="number" id="b12" value="2" class="input-num w-12 h-10 text-center bg-stone-50 border border-stone-300 rounded text-stone-800 font-mono" oninput="calculateMatrix()">
                                <input type="number" id="b21" value="4" class="input-num w-12 h-10 text-center bg-stone-50 border border-stone-300 rounded text-stone-800 font-mono" oninput="calculateMatrix()">
                                <input type="number" id="b22" value="-1" class="input-num w-12 h-10 text-center bg-stone-50 border border-stone-300 rounded text-stone-800 font-mono" oninput="calculateMatrix()">
                            </div>
                        </div>

                        <div class="text-2xl font-bold text-stone-300">=</div>

                        <!-- Result C -->
                        <div class="text-center">
                            <div class="font-bold text-amber-600 mb-2 text-xs uppercase tracking-widest">R√©sultat C</div>
                            <div class="matrix-bracket grid grid-cols-2 gap-2 bg-amber-50/50">
                                <div id="c11" class="w-12 h-10 flex items-center justify-center font-bold text-stone-800 font-mono"></div>
                                <div id="c12" class="w-12 h-10 flex items-center justify-center font-bold text-stone-800 font-mono"></div>
                                <div id="c21" class="w-12 h-10 flex items-center justify-center font-bold text-stone-800 font-mono"></div>
                                <div id="c22" class="w-12 h-10 flex items-center justify-center font-bold text-stone-800 font-mono"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-stone-50 p-4 rounded text-sm text-stone-600 border border-stone-100">
                        <strong class="block mb-2 text-stone-800">D√©tail du calcul pour $C_{1,1}$ :</strong>
                        <span id="calc-detail" class="font-mono text-amber-700 text-base"></span>
                    </div>
                </div>

                <!-- Theory & Properties -->
                <div class="space-y-6">
                    <div>
                        <h3 class="font-bold text-stone-800 mb-2 text-lg">Propri√©t√©s Essentielles</h3>
                        <ul class="list-disc pl-5 space-y-2 text-stone-600 text-sm leading-relaxed">
                            <li><strong>Non-commutativit√© :</strong> En g√©n√©ral, $ A \times B \neq B \times A $.</li>
                            <li><strong>√âl√©ment neutre :</strong> La matrice Identit√© $ I_n $. $ A \times I_n = A $.</li>
                            <li><strong>D√©terminant :</strong> Pour $ A = \begin{pmatrix} a & b \\ c & d \end{pmatrix} $, $ \det(A) = ad - bc $. Si $ \det(A) \neq 0 $, la matrice est inversible.</li>
                        </ul>
                    </div>
                    
                    <div class="bg-white p-5 rounded-lg border border-stone-200 shadow-sm">
                        <h4 class="text-xs font-bold text-stone-500 uppercase tracking-wider mb-4 border-b pb-2">Analyse Actuelle</h4>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="text-center">
                                <span class="text-xs text-stone-400 font-semibold block mb-1">Det(A)</span>
                                <div id="det-a" class="text-2xl font-bold text-stone-800 font-mono"></div>
                            </div>
                            <div class="text-center border-l border-stone-100">
                                <span class="text-xs text-stone-400 font-semibold block mb-1">Det(B)</span>
                                <div id="det-b" class="text-2xl font-bold text-stone-800 font-mono"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION: GRAPHES -->
        <section id="graphes" class="tab-content">
            <div class="mb-8 border-b border-stone-200 pb-4">
                <h2 class="text-3xl font-bold text-stone-800">Le Labo des Graphes</h2>
                <p class="text-stone-600 mt-2">
                    Visualisation de l'algorithme de <strong>Dijkstra</strong>. Un graphe est compos√© de sommets (noeuds) et d'ar√™tes (liens) pond√©r√©es. L'objectif est de trouver le chemin le plus court entre le point de d√©part <span class="font-bold text-emerald-600">S</span> et l'arriv√©e <span class="font-bold text-red-600">E</span>.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Visualizer -->
                <div class="lg:col-span-2 bg-white rounded-xl shadow-sm border border-stone-200 p-1 relative flex flex-col items-center">
                    <div class="absolute top-4 left-4 z-10 flex space-x-2">
                        <button onclick="resetDijkstra()" class="bg-stone-100 hover:bg-stone-200 text-stone-600 px-3 py-1 rounded text-sm font-medium transition-colors border border-stone-300">R√©initialiser</button>
                        <button onclick="stepDijkstra()" id="btn-step" class="bg-amber-500 hover:bg-amber-600 text-white px-3 py-1 rounded text-sm font-medium transition-colors shadow-sm">√âtape Suivante</button>
                    </div>
                    <!-- Chart Container for Canvas (Graph Viz) -->
                    <div class="chart-container">
                        <canvas id="graphCanvas"></canvas>
                    </div>
                </div>

                <!-- Explanation Panel -->
                <div class="bg-stone-50 p-6 rounded-xl border border-stone-100 h-full flex flex-col">
                    <h3 class="font-bold text-stone-800 mb-4 text-lg">√âtat de l'Algorithme</h3>
                    <div id="dijkstra-status" class="space-y-3 flex-grow overflow-y-auto max-h-60 pr-2 custom-scrollbar">
                        <p class="text-sm text-stone-600 italic bg-white p-2 rounded border border-stone-200">Cliquez sur "√âtape Suivante" pour lancer l'algorithme.</p>
                    </div>

                    <div class="mt-8 border-t border-stone-200 pt-4">
                        <h4 class="font-bold text-xs text-stone-500 uppercase tracking-wider mb-2">Concepts Cl√©s</h4>
                        <ul class="text-sm space-y-2 text-stone-600">
                            <li><strong class="text-stone-800">Poids :</strong> Le co√ªt de travers√©e d'une ar√™te (distance, temps).</li>
                            <li><strong class="text-stone-800">Cha√Æne :</strong> Une suite d'ar√™tes cons√©cutives.</li>
                            <li><strong class="text-stone-800">Cycle :</strong> Cha√Æne dont les extr√©mit√©s sont confondues.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION: MARKOV -->
        <section id="markov" class="tab-content">
            <div class="mb-8 border-b border-stone-200 pb-4">
                <h2 class="text-3xl font-bold text-stone-800">Simulateur de Markov</h2>
                <p class="text-stone-600 mt-2">
                    Une cha√Æne de Markov est un processus "sans m√©moire". L'√©tat futur ne d√©pend que de l'√©tat pr√©sent. La formule cl√© est $ P_{n+1} = P_n \times T $. Observez comment les probabilit√©s convergent vers un <strong>√âtat Stable</strong>.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Controls -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200 lg:col-span-1">
                    <h3 class="font-bold text-stone-800 mb-4 text-lg">Param√®tres de Transition</h3>
                    
                    <div class="mb-6">
                        <label class="block text-xs font-bold text-stone-500 uppercase mb-2 tracking-wide">Matrice de Transition $T$</label>
                        <div class="grid grid-cols-2 gap-3 text-center text-sm">
                            <div class="p-3 bg-stone-50 border border-stone-200 rounded-lg">
                                <span class="block text-stone-400 text-xs mb-1">A vers A</span>
                                <input type="number" id="t-aa" value="0.9" step="0.05" min="0" max="1" class="w-full text-center bg-transparent font-bold text-amber-600 outline-none text-lg" onchange="updateMarkov()">
                            </div>
                            <div class="p-3 bg-stone-50 border border-stone-200 rounded-lg">
                                <span class="block text-stone-400 text-xs mb-1">A vers B</span>
                                <span id="t-ab" class="block font-bold text-stone-500 text-lg">0.1</span>
                            </div>
                            <div class="p-3 bg-stone-50 border border-stone-200 rounded-lg">
                                <span class="block text-stone-400 text-xs mb-1">B vers A</span>
                                <input type="number" id="t-ba" value="0.2" step="0.05" min="0" max="1" class="w-full text-center bg-transparent font-bold text-emerald-600 outline-none text-lg" onchange="updateMarkov()">
                            </div>
                            <div class="p-3 bg-stone-50 border border-stone-200 rounded-lg">
                                <span class="block text-stone-400 text-xs mb-1">B vers B</span>
                                <span id="t-bb" class="block font-bold text-stone-500 text-lg">0.8</span>
                            </div>
                        </div>
                        <p class="text-xs text-stone-400 mt-2 italic">* La somme des lignes doit valoir 1.</p>
                    </div>

                    <div class="mb-6 pt-4 border-t border-stone-100">
                        <label class="block text-xs font-bold text-stone-500 uppercase mb-2 tracking-wide">√âtat Initial $P_0$</label>
                        <div class="flex items-center gap-3">
                            <span class="text-sm font-bold text-amber-600 whitespace-nowrap w-12">A: <span id="p0-a-val">0.6</span></span>
                            <input type="range" id="p0-slider" min="0" max="1" step="0.1" value="0.6" class="flex-grow h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-amber-500" oninput="updateMarkov()">
                            <span class="text-sm font-bold text-emerald-600 whitespace-nowrap w-12 text-right">B: <span id="p0-b-val">0.4</span></span>
                        </div>
                    </div>
                </div>

                <!-- Visualization -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-stone-200 lg:col-span-2 flex flex-col justify-center">
                    <h3 class="font-bold text-stone-800 mb-2 ml-2 text-lg">Convergence des Probabilit√©s ($P_n$)</h3>
                    <!-- Chart Container -->
                    <div class="chart-container">
                        <canvas id="markovChart"></canvas>
                    </div>
                    <div class="mt-4 text-center">
                        <span class="inline-block px-3 py-1 bg-amber-50 text-amber-800 text-xs rounded-full font-bold border border-amber-100 mr-2">
                            √âtat Stable estim√© (A): <span id="stable-a">--</span>
                        </span>
                        <span class="inline-block px-3 py-1 bg-emerald-50 text-emerald-800 text-xs rounded-full font-bold border border-emerald-100">
                            √âtat Stable estim√© (B): <span id="stable-b">--</span>
                        </span>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-stone-200 mt-auto">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <p class="text-center text-sm text-stone-400">
                G√©n√©r√© √† partir du Module Maths 2: Matrices et graphes. 
                <span class="block sm:inline">Application √† but √©ducatif.</span>
            </p>
        </div>
    </footer>

    <!-- LOGIC -->
    <script>
        // --- NAVIGATION STATE ---
        function switchTab(tabId) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(el => {
                el.classList.remove('active');
            });
            // Show selected tab
            document.getElementById(tabId).classList.add('active');

            // Update nav styling
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('border-amber-500', 'text-stone-900');
                el.classList.add('border-transparent', 'text-stone-500');
            });
            const activeNav = document.getElementById('nav-' + tabId);
            if(activeNav) {
                activeNav.classList.remove('border-transparent', 'text-stone-500');
                activeNav.classList.add('border-amber-500', 'text-stone-900');
            }

            // Trigger redraws if necessary (canvas sizing fix)
            if (tabId === 'graphes') {
                setTimeout(drawGraph, 50);
            }
        }

        // --- SECTION 1: MATRICES LOGIC ---
        function calculateMatrix() {
            // Get inputs
            const a11 = parseFloat(document.getElementById('a11').value) || 0;
            const a12 = parseFloat(document.getElementById('a12').value) || 0;
            const a21 = parseFloat(document.getElementById('a21').value) || 0;
            const a22 = parseFloat(document.getElementById('a22').value) || 0;

            const b11 = parseFloat(document.getElementById('b11').value) || 0;
            const b12 = parseFloat(document.getElementById('b12').value) || 0;
            const b21 = parseFloat(document.getElementById('b21').value) || 0;
            const b22 = parseFloat(document.getElementById('b22').value) || 0;

            // Calculate C = A * B
            // c11 = a11*b11 + a12*b21
            const c11 = (a11 * b11) + (a12 * b21);
            const c12 = (a11 * b12) + (a12 * b22);
            const c21 = (a21 * b11) + (a22 * b21);
            const c22 = (a21 * b12) + (a22 * b22);

            // Update UI
            document.getElementById('c11').innerText = parseFloat(c11.toFixed(2));
            document.getElementById('c12').innerText = parseFloat(c12.toFixed(2));
            document.getElementById('c21').innerText = parseFloat(c21.toFixed(2));
            document.getElementById('c22').innerText = parseFloat(c22.toFixed(2));

            // Update Detail
            const detailHtml = `${a11} √ó ${b11} + ${a12} √ó ${b21} = <span class="font-bold border-b-2 border-amber-400">${c11}</span>`;
            const detailEl = document.getElementById('calc-detail');
            detailEl.innerHTML = detailHtml;
            
            // Re-render MathJax if detail content contains math, 
            // but here it's mostly numbers. If we used math symbols, we'd call typeset.
            // window.MathJax.typesetPromise && window.MathJax.typesetPromise([detailEl]);

            // Determinants
            const detA = (a11 * a22) - (a12 * a21);
            const detB = (b11 * b22) - (b12 * b21);
            document.getElementById('det-a').innerText = parseFloat(detA.toFixed(2));
            document.getElementById('det-b').innerText = parseFloat(detB.toFixed(2));
        }

        // --- SECTION 2: GRAPH (DIJKSTRA) LOGIC (CANVAS) ---
        const canvas = document.getElementById('graphCanvas');
        const ctx = canvas.getContext('2d');
        
        // Define Graph Data (Based on example in PDF)
        const nodes = {
            'S': {x: 100, y: 200, label: 'S'},
            'A': {x: 250, y: 100, label: 'A'},
            'B': {x: 250, y: 300, label: 'B'},
            'I': {x: 400, y: 200, label: 'I'},
            'E': {x: 550, y: 200, label: 'E'} // End
        };

        const edges = [
            {from: 'S', to: 'A', weight: 12},
            {from: 'S', to: 'B', weight: 9},
            {from: 'A', to: 'I', weight: 30},
            {from: 'B', to: 'I', weight: 25},
            {from: 'B', to: 'A', weight: 5},
            {from: 'I', to: 'E', weight: 16},
            {from: 'A', to: 'E', weight: 40} // Added shortcut for complexity simulation based on visual graph
        ];

        let dijkstraState = {
            step: 0,
            distances: {},
            visited: [],
            current: null
        };

        function resizeCanvas() {
            // Make canvas high res
            const dpr = window.devicePixelRatio || 1;
            const container = canvas.parentElement;
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            canvas.width = width * dpr;
            canvas.height = height * dpr;
            
            // Normalize internal scaling to a 800x400 grid for simplicity of coords
            const scaleX = (width * dpr) / 650;
            const scaleY = (height * dpr) / 400;
            
            ctx.setTransform(1, 0, 0, 1, 0, 0); // Reset
            ctx.scale(scaleX, scaleY); 
            drawGraph();
        }

        window.addEventListener('resize', resizeCanvas);

        function drawGraph() {
            // Clear
            ctx.clearRect(0, 0, 800, 600); // Clear large area (logical coords)

            // Draw Edges
            edges.forEach(edge => {
                const start = nodes[edge.from];
                const end = nodes[edge.to];
                
                ctx.beginPath();
                ctx.moveTo(start.x, start.y);
                ctx.lineTo(end.x, end.y);
                
                // Color logic
                let strokeStyle = '#cbd5e1'; // Default slate-300
                let lineWidth = 2;

                // Simple visual highlight if both nodes are visited
                if (dijkstraState.visited.includes(edge.from) && dijkstraState.visited.includes(edge.to)) {
                   strokeStyle = '#94a3b8'; // Darker slate
                }
                
                ctx.strokeStyle = strokeStyle;
                ctx.lineWidth = lineWidth;
                ctx.stroke();

                // Weight Label
                const midX = (start.x + end.x) / 2;
                const midY = (start.y + end.y) / 2;
                ctx.fillStyle = '#fff';
                ctx.beginPath();
                ctx.arc(midX, midY, 12, 0, 2*Math.PI);
                ctx.fill();
                ctx.strokeStyle = '#e2e8f0';
                ctx.lineWidth = 1;
                ctx.stroke();
                
                ctx.fillStyle = '#64748b';
                ctx.font = '12px Inter';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(edge.weight, midX, midY);
            });

            // Draw Nodes
            for (let id in nodes) {
                const node = nodes[id];
                
                ctx.beginPath();
                ctx.arc(node.x, node.y, 25, 0, 2 * Math.PI);
                
                // Fill logic
                if (id === dijkstraState.current) {
                    ctx.fillStyle = '#f59e0b'; // Amber 500 (Current)
                } else if (dijkstraState.visited.includes(id)) {
                    ctx.fillStyle = '#10b981'; // Emerald 500 (Visited)
                } else {
                    ctx.fillStyle = '#fff'; // Default
                }
                
                ctx.fill();
                
                // Stroke logic
                ctx.strokeStyle = (id === 'S' || id === 'E') ? '#334155' : '#94a3b8';
                ctx.lineWidth = 3;
                ctx.stroke();

                // Node Label
                ctx.fillStyle = (id === dijkstraState.current || dijkstraState.visited.includes(id)) ? '#fff' : '#334155';
                ctx.font = 'bold 16px Inter';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(node.label, node.x, node.y);

                // Distance Label (Above node)
                const dist = dijkstraState.distances[id];
                const distText = dist === Infinity ? '‚àû' : dist;
                ctx.fillStyle = '#0f172a';
                ctx.font = 'bold 14px Inter';
                ctx.fillText(distText, node.x, node.y - 35);
            }
        }

        function resetDijkstra() {
            dijkstraState = {
                step: 0,
                distances: {},
                visited: [],
                current: null
            };
            // Init distances
            for (let id in nodes) dijkstraState.distances[id] = Infinity;
            dijkstraState.distances['S'] = 0;
            
            document.getElementById('dijkstra-status').innerHTML = '<p class="text-sm text-stone-600 bg-white p-2 rounded border border-stone-200">Initialisation : Distance(S) = 0, autres = ‚àû.</p>';
            document.getElementById('btn-step').disabled = false;
            document.getElementById('btn-step').innerText = "√âtape Suivante";
            document.getElementById('btn-step').classList.remove('opacity-50', 'cursor-not-allowed');
            
            drawGraph();
        }

        function stepDijkstra() {
            const { distances, visited } = dijkstraState;
            
            // Find unvisited node with smallest distance
            let u = null;
            let min = Infinity;
            for (let id in nodes) {
                if (!visited.includes(id) && distances[id] < min) {
                    min = distances[id];
                    u = id;
                }
            }

            if (u === null) {
                // Done or no path
                dijkstraState.current = null;
                const statusEl = document.getElementById('dijkstra-status');
                const newItem = document.createElement('p');
                newItem.className = "text-sm font-bold text-emerald-600 mt-2 bg-emerald-50 p-2 rounded border border-emerald-100";
                newItem.innerText = "Algorithme termin√© !";
                statusEl.insertBefore(newItem, statusEl.firstChild);

                document.getElementById('btn-step').disabled = true;
                document.getElementById('btn-step').innerText = "Termin√©";
                document.getElementById('btn-step').classList.add('opacity-50', 'cursor-not-allowed');
                drawGraph();
                return;
            }

            dijkstraState.current = u;
            dijkstraState.visited.push(u);

            // Update neighbors
            let updates = [];
            edges.forEach(edge => {
                if (edge.from === u) {
                    let v = edge.to;
                    if (!visited.includes(v)) {
                        let alt = distances[u] + edge.weight;
                        if (alt < distances[v]) {
                            distances[v] = alt;
                            updates.push(`${v} (${alt})`);
                        }
                    }
                }
            });

            // Status Text
            let msg = `Visite de <strong>${u}</strong>. `;
            if(updates.length > 0) msg += `Mise √† jour : ${updates.join(', ')}.`;
            else msg += `Pas de mise √† jour.`;
            
            const statusEl = document.getElementById('dijkstra-status');
            const newItem = document.createElement('div');
            newItem.className = "text-sm text-stone-600 bg-white p-2 rounded border border-stone-100 mb-2 shadow-sm";
            newItem.innerHTML = msg;
            statusEl.insertBefore(newItem, statusEl.firstChild);
            
            drawGraph();
            dijkstraState.step++;
        }

        // --- SECTION 3: MARKOV LOGIC (CHART.JS) ---
        let markovChart = null;

        function initMarkovChart() {
            const ctxM = document.getElementById('markovChart').getContext('2d');
            markovChart = new Chart(ctxM, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                        {
                            label: '√âtat A',
                            borderColor: '#d97706', // Amber 600
                            backgroundColor: 'rgba(217, 119, 6, 0.1)',
                            data: [],
                            tension: 0.3,
                            fill: false,
                            pointRadius: 2
                        },
                        {
                            label: '√âtat B',
                            borderColor: '#10b981', // Emerald 500
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            data: [],
                            tension: 0.3,
                            fill: false,
                            pointRadius: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            min: 0,
                            max: 1,
                            title: { display: true, text: 'Probabilit√©' }
                        },
                        x: {
                            title: { display: true, text: '√âtapes (n)' }
                        }
                    },
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: { mode: 'index', intersect: false }
                    }
                }
            });
            updateMarkov();
        }

        function updateMarkov() {
            // Inputs
            const tAA = parseFloat(document.getElementById('t-aa').value);
            const tBA = parseFloat(document.getElementById('t-ba').value);
            
            // Constraints
            const tAB = parseFloat((1 - tAA).toFixed(2));
            const tBB = parseFloat((1 - tBA).toFixed(2));
            
            // Update UI Readonlys
            document.getElementById('t-ab').innerText = tAB;
            document.getElementById('t-bb').innerText = tBB;

            // Initial State
            const p0A = parseFloat(document.getElementById('p0-slider').value);
            const p0B = parseFloat((1 - p0A).toFixed(2));
            
            document.getElementById('p0-a-val').innerText = p0A;
            document.getElementById('p0-b-val').innerText = p0B;

            // Simulation (n=0 to 15)
            const steps = 15;
            let currentA = p0A;
            let currentB = p0B;
            
            let dataA = [currentA];
            let dataB = [currentB];
            let labels = [0];

            for (let i = 1; i <= steps; i++) {
                // P_n+1 = P_n * T
                // nextA = prevA * T_AA + prevB * T_BA
                // nextB = prevA * T_AB + prevB * T_BB
                let nextA = (currentA * tAA) + (currentB * tBA);
                let nextB = (currentA * tAB) + (currentB * tBB);
                
                dataA.push(nextA);
                dataB.push(nextB);
                labels.push(i);
                
                currentA = nextA;
                currentB = nextB;
            }

            // Update Chart
            markovChart.data.labels = labels;
            markovChart.data.datasets[0].data = dataA;
            markovChart.data.datasets[1].data = dataB;
            markovChart.update();

            // Estimate Stable State (Solving system manually or just taking last value)
            // System: x = x*TAA + y*TBA, x+y=1 -> x = x*TAA + (1-x)*TBA -> x = xTAA + TBA - xTBA -> x(1 - TAA + TBA) = TBA -> x = TBA / (1 - TAA + TBA)
            const denominator = (1 - tAA + tBA);
            let stableA, stableB;
            
            if (denominator !== 0) {
                 stableA = tBA / denominator;
                 stableB = 1 - stableA;
                 document.getElementById('stable-a').innerText = stableA.toFixed(3);
                 document.getElementById('stable-b').innerText = stableB.toFixed(3);
            } else {
                 document.getElementById('stable-a').innerText = "Ind√©fini";
                 document.getElementById('stable-b').innerText = "Ind√©fini";
            }
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            calculateMatrix();
            resizeCanvas();
            resetDijkstra();
            initMarkovChart();
        });

    </script>
</body>
</html>
